<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Voice ¬∑ Expression Field ‚Äî 128 Hz</title>
<meta name="description" content="Voice ‚Äî an expression field with a seamless 128 Hz tone. Perfect-loop engine, fine detune, lock-screen friendly." />
<meta name="theme-color" content="#0b0d11" media="(prefers-color-scheme: dark)">
<meta name="theme-color" content="#0b0d11">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<style>
  :root{ --bg:#0b0d11; --ink:#ecf1f9; --muted:#aeb4c4; --ring:#1a2236; --card:#0f1427; --aqua:#b5f0ea; }
  *{box-sizing:border-box}
  html,body{margin:0;height:100%;background:#0b0d11;color:var(--ink);font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial}
  @media(prefers-color-scheme:light){html,body{background:#0b0d11;color:var(--ink)}}
  a{color:inherit;text-decoration:none}
  .wrap{max-width:900px;margin:0 auto;padding:16px 16px 72px}
  header{padding:12px 16px 0}
  .brand{display:flex;align-items:center;gap:10px}
  .glyph{width:28px;height:28px;border-radius:8px;background:linear-gradient(135deg,#1b2337,#0f1220);display:grid;place-items:center;box-shadow:inset 0 0 0 1px #222b46}
  .glyph span{font-size:16px}
  h1{font-size:18px;margin:0 0 6px 0}
  .tag{font-size:12px;color:#c9d1e2}
  .ribbon{margin:10px 0 8px;display:flex;gap:8px;overflow:auto;padding-bottom:2px;-webkit-overflow-scrolling:touch;scrollbar-width:none}
  .ribbon::-webkit-scrollbar{display:none}
  .chip{white-space:nowrap;font-size:13px;padding:8px 12px;border-radius:999px;flex:0 0 auto;background:#121a34;border:1px solid #2a3457;color:#e5ebfb}
  .chip[data-hi="1"]{border-color:#2e6f78;background:#10262a}
  .card{background:linear-gradient(180deg,#0f1427 0%, #0b0f1e 100%);border:1px solid var(--ring);border-radius:14px;padding:14px;box-shadow:0 10px 28px #0007;margin:12px 0}
  .row{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
  .controls{display:grid;grid-template-columns:1fr;gap:10px}
  @media(min-width:660px){ .controls{grid-template-columns:1fr 1fr 1fr} }
  button,.pill{appearance:none;border:1px solid #2a3457;background:#121a34;color:var(--ink);padding:10px 14px;border-radius:999px;font-weight:600;letter-spacing:.2px}
  button:active{transform:translateY(1px)}
  .on{background:linear-gradient(90deg,#0f3440,#0b2530);border-color:#2e6f78;box-shadow:0 0 0 1px #17434a inset, 0 0 20px #0c2b30}
  .badge{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;background:#121a34;border:1px solid #2a3457;font-size:13px}
  label{font-size:13px;color:var(--muted)}
  input[type="range"]{width:100%}
  .meter{height:8px;background:#0e1326;border:1px solid #1f2744;border-radius:999px;overflow:hidden}
  .bar{height:100%;width:0%;background:linear-gradient(90deg,#b5f0ea,#ecf1f9);transition:width .35s ease}
  .note{font-size:14px;color:#cfd6ea}
  .footer{opacity:.9;text-align:center;font-size:12px;color:#aab1c6;margin-top:10px}
</style>
</head>
<body>
  <header class="wrap" aria-label="Site header">
    <div class="brand">
      <div class="glyph"><span>üéôÔ∏è</span></div>
      <div>
        <h1>Voice ¬∑ <span style="text-shadow:0 0 14px #b5f0ea77">Expression Field</span></h1>
        <div class="tag">Seamless 128 Hz ¬∑ perfect-loop engine ¬∑ lock-screen friendly</div>
      </div>
    </div>
    <nav class="ribbon" aria-label="Sites">
      <a class="chip" href="https://mirrorhoney.plnt.earth/">MirrorHoney</a>
      <a class="chip" href="https://mirrorsea.plnt.earth/">Mirror Sea</a>
      <a class="chip" href="https://earth.plnt.earth/">Earth</a>
      <a class="chip" href="https://honey.plnt.earth/">Honey</a>
      <a class="chip" href="https://mask.plnt.earth/">Mask</a>
      <a class="chip" data-hi="1" href="https://voice.plnt.earth/">Voice</a>
      <a class="chip" href="https://jar.plnt.earth/">Jar</a>
      <a class="chip" href="https://froot.plnt.earth/">Froot</a>
      <a class="chip" href="https://tunes.plnt.earth/">Tunes</a>
      <a class="chip" href="https://bridge.plnt.earth/">Bridge</a>
    </nav>
  </header>

  <main class="wrap">
    <section class="card" aria-label="Voice controls">
      <div class="row" style="justify-content:space-between">
        <div class="badge">üéôÔ∏è Voice ‚Äî 128 Hz</div>
        <div class="badge">Status: <strong id="status">Off</strong></div>
      </div>
      <div class="row" style="margin-top:8px">
        <button id="start" class="pill">‚ñ∂Ô∏é Start</button>
        <button id="stop"  class="pill">‚ñ† Stop</button>
        <button id="newtab" class="pill">‚ÜóÔ∏é Open in New Tab</button>
        <a id="download" class="pill" download="voice-128hz.wav" href="#">‚¨áÔ∏é Download</a>
      </div>
      <div class="controls" style="margin-top:10px">
        <div><label for="level">Level</label><input id="level" type="range" min="0" max="100" value="60" step="1" /></div>
        <div><label for="detune">Fine Detune (¬±2%)</label><input id="detune" type="range" min="-2" max="2" value="0" step="0.01" /></div>
        <div><label for="loopsec">Loop length (sec)</label><input id="loopsec" type="range" min="60" max="600" value="180" step="30" /></div>
      </div>
      <div class="meter" style="margin-top:10px"><div id="bar" class="bar"></div></div>
      <p class="note" style="margin-top:10px">Warm for 30‚Äì60s. When the chest feels effortless, speak one sentence you can ship today.</p>
      <audio id="tone" preload="auto" loop playsinline></audio>
    </section>
    <div class="footer">Night-safe UI ¬∑ zero external libs ¬∑ same engine across constellation.</div>
  </main>

<script>
(() => {
  const tone=document.getElementById('tone'), status=document.getElementById('status');
  const start=document.getElementById('start'), stop=document.getElementById('stop');
  const newtab=document.getElementById('newtab'), download=document.getElementById('download');
  const level=document.getElementById('level'), detune=document.getElementById('detune'), loopsec=document.getElementById('loopsec');
  const bar=document.getElementById('bar');
  let url=null, blob=null, tabURL=null, on=false;

  function setBadge(v){ status.textContent=v?'On':'Off'; start.classList.toggle('on',v); }
  function applyLevel(){ tone.volume=Math.min(1,Math.max(0,level.value/100)); bar.style.width=Math.round(tone.volume*100)+'%'; }
  function applyDetune(){ const p=parseFloat(detune.value)||0; tone.playbackRate=1+(p/100); }

  function makeWav(freq, seconds){
    const sr=48000, secs=Math.max(5,Math.min(600,seconds||180));
    const spc=sr/freq; const cyc=Math.round((sr*secs)/spc); const total=Math.floor(cyc*spc);
    const data=new Int16Array(total), amp=0.25*0x7FFF, fade=Math.floor(sr*0.01);
    for(let i=0;i<total;i++){ const s=Math.sin(2*Math.PI*freq*(i/sr));
      let w=1; if(i<fade){const k=i/fade; w=0.5-0.5*Math.cos(Math.PI*k);} else if(i>total-fade){const k=(total-i)/fade; w=0.5-0.5*Math.cos(Math.PI*k);}
      data[i]=Math.round(amp*s*w);
    }
    const header=new ArrayBuffer(44), dv=new DataView(header); const put=(o,s)=>{for(let i=0;i<s.length;i++)dv.setUint8(o+i,s.charCodeAt(i));};
    const bytes=data.length*2; put(0,"RIFF"); dv.setUint32(4,36+bytes,true); put(8,"WAVE"); put(12,"fmt "); dv.setUint32(16,16,true);
    dv.setUint16(20,1,true); dv.setUint16(22,1,true); dv.setUint32(24,sr,true); dv.setUint32(28,sr*2,true); dv.setUint16(32,2,true); dv.setUint16(34,16,true);
    put(36,"data"); dv.setUint32(40,bytes,true);
    const out=new Uint8Array(44+bytes); out.set(new Uint8Array(header),0); out.set(new Uint8Array(new Int16Array(data).buffer),44);
    return new Blob([out],{type:"audio/wav"});
  }

  function ensureTone(){ if(!blob){ blob=makeWav(128, parseInt(loopsec.value,10)||180); url=URL.createObjectURL(blob); tone.src=url; download.href=url; } }
  async function doStart(){ ensureTone(); tone.currentTime=0; applyDetune(); applyLevel(); try{ await tone.play(); on=true; setBadge(true);}catch(_){ } }
  function doStop(){ try{ tone.pause(); }catch(_){ } on=false; setBadge(false); }

  loopsec.addEventListener('input', ()=>{ if(on) return; blob=null; url=null; ensureTone(); });
  level.addEventListener('input', applyLevel); detune.addEventListener('input', applyDetune);
  start.addEventListener('click', doStart); stop.addEventListener('click', doStop);

  newtab.addEventListener('click', ()=>{
    ensureTone();
    const html=`<!doctype html><meta name="viewport" content="width=device-width,initial-scale=1"><title>Voice 128 Hz</title>
      <style>html,body{margin:0;height:100%;background:#000;color:#fff;display:grid;place-items:center;font:16px system-ui}</style>
      <audio src="${url}" loop controls autoplay playsinline style="width:90%"></audio>
      <p style="opacity:.8">Voice ‚Äî 128 Hz ¬∑ Perfect loop ¬∑ Lock-screen friendly tab.</p>`;
    const b=new Blob([html],{type:"text/html"}); tabURL=URL.createObjectURL(b); window.open(tabURL,"_blank","noopener");
  });

  setBadge(false); bar.style.width=level.value+'%';
})();
</script>
</body>
</html>
