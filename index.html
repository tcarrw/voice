<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Voice Room ‚Äî Ariana v0.3.0 ¬∑ Illumina (Froot Core Ready)</title>
<meta name="theme-color" content="#0b0d11" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<style>
  :root{
    --bg:#0b0d11; --card:#12151b; --ink:#EDECF5; --muted:#9aa3ad;
    --accent:#f6d7e6; --accent-2:#f8f1e7; --accent-3:#f2b8a0; --accent-4:#e7e0c3; --accent-5:#c9b6e7;
    --good:#7ee787; --warn:#f7c843; --bad:#f47174;
  }
  html,body{height:100%;background:var(--bg);color:var(--ink);font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,Apple Color Emoji,Segoe UI Emoji;}
  *{box-sizing:border-box}
  .wrap{max-width:1200px;margin:0 auto;padding:16px 14px 140px}
  header{position:sticky;top:0;background:linear-gradient(180deg,rgba(11,13,17,.9),rgba(11,13,17,.6) 60%,transparent);backdrop-filter: blur(8px);z-index:20}
  .bar{display:flex;gap:8px;flex-wrap:wrap;align-items:center;padding:12px 0}
  .title{font-weight:800;font-size:22px;letter-spacing:.2px}
  .subtle{color:var(--muted);font-size:12px}
  button,.btn{background:#1a1f27;color:var(--ink);border:1px solid #222936;border-radius:12px;padding:10px 12px;font-weight:600;cursor:pointer}
  button:hover{border-color:#2d3645}
  .ghost{background:transparent;border-color:#2a3240}
  .primary{background:linear-gradient(180deg,#2a3240,#1d2330);border-color:#394356}
  .accent{background:linear-gradient(180deg,var(--accent),#f0bed4);color:#1b0f14;border:0}
  input[type="file"]{display:none}

  /* Layout: Player on top; below = two columns: left list, right editor drawer */
  .stack{display:flex;flex-direction:column;gap:12px}
  .cols{display:grid;grid-template-columns: 1fr 380px; gap:12px}
  @media(max-width:1100px){.cols{grid-template-columns:1fr}}

  .panel{background:var(--card);border:1px solid #222936;border-radius:16px;padding:12px}
  .player{aspect-ratio:16/9; background:#0f131a; border:1px solid #1e2633; border-radius:12px; overflow:hidden}

  .list .head,.row{display:grid;grid-template-columns: 44px 2fr 1fr 120px; gap:10px; align-items:center}
  .list .head{padding:10px 12px;border-bottom:1px solid #1b212c;color:var(--muted);font-size:12px}
  .row{padding:10px 12px;border-bottom:1px solid #1b212c}
  .row:last-child{border-bottom:0}
  .idx{width:44px;text-align:center;color:#8b94a1}
  .song-title{font-weight:700}
  .tag{display:inline-flex;align-items:center;gap:6px;font-size:11px;padding:4px 8px;border-radius:999px;border:1px solid #2b3444;color:var(--muted)}
  .kbd{font-family: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace; font-size:12px; background:#0f131a; border:1px solid #2a3240; padding:2px 6px; border-radius:6px;}
  .controls{display:flex;gap:8px;flex-wrap:wrap}

  /* Drawer (Editor) */
  .drawer{position:sticky; top:76px; height:max-content; display:none}
  .drawer.on{display:block}
  .drawer h3{margin:6px 0 8px}
  .field{display:flex;flex-direction:column;gap:6px}
  .field input,.field textarea{width:100%;background:#0f131a;border:1px solid #263142;border-radius:10px;padding:10px;color:var(--ink)}
  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .grid3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}
  .hint{font-size:12px;color:var(--muted)}
  .verify{color:#1b0f14;background:linear-gradient(180deg,#ffd1d9,#ffb3c3);border:0;border-radius:10px;padding:4px 8px;font-weight:700;font-size:11px}

  .footer{position:fixed;left:0;right:0;bottom:0;background:linear-gradient(180deg,rgba(11,13,17,.0),rgba(11,13,17,.9));backdrop-filter: blur(8px);}
  .footbar{max-width:1200px;margin:0 auto;display:flex;align-items:center;gap:10px;padding:10px 14px}
  .status-dot{width:10px;height:10px;border-radius:50%;background:#374151;border:1px solid #111}
  .status-dot.on{background:var(--good)}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="bar">
        <div>
          <div class="title">Voice Room ‚Äî <span style="color:var(--accent)">Ariana</span> <span class="tag">v0.2</span></div>
          <div class="subtle">Mode: <b>VOICE</b> ¬∑ Palette: Pearl‚ÄëRose ¬∑ Engine: Froot Core compatible</div>
        </div>
        <div style="margin-left:auto" class="controls">
          <label class="btn ghost" title="Load a JSON pack">
            <input id="fileIn" type="file" accept="application/json" />üì• Import
          </label>
          <button class="btn primary" id="saveAll">üíæ Save</button>
          <button class="btn" id="exportBtn">üì§ Export Edited Names & IDs</button>
        </div>
      </div>
    </header>

    <section class="panel">
      <div class="controls" style="justify-content:space-between;align-items:center">
        <div class="controls">
          <button id="prevBtn">‚èÆ Prev</button>
          <button id="playBtn" class="primary">‚ñ∂Ô∏è Play</button>
          <button id="pauseBtn">‚è∏ Pause</button>
          <button id="nextBtn">‚è≠ Next</button>
          <button id="loopBtn" class="ghost" title="Loop queue">üîÅ Loop</button>
          <span class="tag">Queue: <span id="qStatus">7 ¬∑ loop</span></span>
        </div>
        <div class="controls">
          <button id="toneToggle" class="ghost">üîä Tone: Off</button>
          <label class="tag">Level <input id="toneGain" type="range" min="0" max="100" value="30" /></label>
          <span>Hz <span id="toneHzBadge" class="kbd">‚Äî</span></span>
        </div>
      </div>
      <div id="player" class="player"></div>
      <div class="hint" style="margin-top:8px">Tip: keep tone ~ ‚àí24 to ‚àí30 dB under the song; you can AirPlay the video and keep the tone on-device.</div>
    </section>

    <div class="cols">
      <section class="panel list">
        <div class="head"><div>#</div><div>Title / Artist</div><div>Seed</div><div>Actions</div></div>
        <div id="rows"></div>
      </section>

      <aside id="drawer" class="panel drawer">
        <h3 id="dTitle">Edit</h3>
        <div class="grid3">
          <div class="field"><label class="hint">Title</label><input id="dTitleIn"></div>
          <div class="field"><label class="hint">YouTube ID <small>(11 chars)</small></label><input id="dYt"></div>
          <div class="field"><label class="hint">Hex Color</label><input id="dHex"></div>
        </div>
        <div class="grid2" style="margin-top:10px">
          <div class="field"><label class="hint">Seed</label><input id="dSeed"></div>
          <div class="field"><label class="hint">Tone (Hz)</label><input id="dTone" type="number" step="0.01"></div>
        </div>
        <div class="field" style="margin-top:10px"><label class="hint">Website Blurb</label><textarea id="dBlurb" rows="3"></textarea></div>
        <div class="field" style="margin-top:10px"><label class="hint">Note to Ariana (from us)</label><input id="dNote"></div>
        <div class="controls" style="margin-top:12px;justify-content:flex-end">
          <button id="dCancel" class="ghost">Cancel</button>
          <button id="dSave" class="primary">üíæ Save</button>
        </div>
        <div class="hint" style="margin-top:8px">Order: <span class="kbd">Click a row ‚Üí Edit</span> (drawer opens) ‚Üí <span class="kbd">Save</span>. Use <b>Export</b> anytime.</div>
      </aside>
    </div>

    <section class="panel" style="margin-top:12px">
      <details open>
        <summary><b>Easy Steps</b> (desktop & phone)</summary>
        <ol style="line-height:1.8">
          <li><b>Play</b>: Click ‚ñ∂Ô∏è on any row. Tone auto-sets per song. Toggle with <b>Tone</b>.</li>
          <li><b>Edit</b>: Click ‚úèÔ∏è on a row ‚Üí drawer opens on the right with big fields.</li>
          <li><b>Paste the YouTube ID</b>: 11 characters from the URL after <span class="kbd">v=</span>. (Example: <span class="kbd">ffxKSjUwKdU</span>).</li>
          <li><b>Save</b>: Hit üíæ in the drawer. The row updates and is ready to play.</li>
          <li><b>Export</b>: Click <b>Export Edited Names & IDs</b> ‚Üí JSON saves to disk (Froot‚ÄëCore ready).</li>
          <li><b>Import</b>: Bring that JSON into other PLNT sites or back here to merge changes.</li>
        </ol>
      </details>
    </section>

  </div>

  <div class="footer">
    <div class="footbar">
      <div class="status-dot" id="ytStatus"></div><span class="subtle">YouTube API</span>
      <div class="status-dot" id="audioStatus"></div><span class="subtle">Audio Engine</span>
      <div class="status-dot" id="loopStatus"></div><span class="subtle">Loop</span>
      <div style="margin-left:auto" class="subtle">Energy Path: <b>Ground ‚Üí Flow ‚Üí Rest</b></div>
    </div>
  </div>

<script>
// ---------------------------
// Preloaded pack (best‚Äëeffort official IDs; please verify)
// ---------------------------
const PACK = [
  { artist:"Ariana Grande", title:"no tears left to cry", yt:"ffxKSjUwKdU", hex:"#F6D7E6", toneHz:160, seed:"Pearl Lift", tags:["Voice","Lift","Resilience"], blurb:"Switch-on song: when the day tilts sideways, we tilt back up.", noteToAri:"This is our click-into-buoyancy‚Äîthank you for making resilience feel musical.", expl:"Bounce-back energy; flipping heaviness to upward spiral (Bee ‚Üí Flow)." },
  { artist:"Ariana Grande", title:"be alright", yt:"", hex:"#F8F1E7", toneHz:128.15, seed:"Little Mantra", tags:["Calm","Breath"], blurb:"Pocket calm. Two minutes with this resets the room.", noteToAri:"We use this like breath tabs‚Äîthank you for a soft way to reset.", expl:"Micro-mantra rhythm; teaches body calm via small, repeatable phrases." },
  { artist:"Ariana Grande", title:"into you", yt:"1ekZEVeXwek", hex:"#F2B8A0", toneHz:192, seed:"Playful Precision", tags:["Articulation","Sparkle"], blurb:"Flirt without static‚Äîclarity that still winks.", noteToAri:"This track teaches us clean edges without losing warmth.", expl:"Playful precision; consonant sparkle trains articulation (Voice mode)." },
  { artist:"Ariana Grande", title:"positions", yt:"tcYodQoapMg", hex:"#E7E0C3", toneHz:216, seed:"Agile Center", tags:["Switching","Timing"], blurb:"Move parts around‚Äîcenter stays put.", noteToAri:"We practice flexible clarity with this‚Äîit keeps work playful.", expl:"Adaptive agility; role-shifting without losing center (Bee agility drills)." },
  { artist:"Ariana Grande", title:"god is a woman", yt:"kHLHSlExFis", hex:"#C9B6E7", toneHz:256, seed:"Open Glow", tags:["Embodied","Open"], blurb:"Stand soft, sound big.", noteToAri:"This is our posture reminder‚Äîease first, power follows.", expl:"Embodied voice; open jaw & chest, confidence without push." },
  { artist:"Ariana Grande", title:"imagine", yt:"", hex:"#EFEAE2", toneHz:144, seed:"Kind Vision", tags:["Message","You‚ÜíHer"], blurb:"A soft offer: we could make a little world.", noteToAri:"This is me speaking quietly: if it‚Äôs right, let‚Äôs build something kind.", expl:"Your gentle, sincere ask; vision over demand (You ‚Üí Ariana)." },
  { artist:"Ariana Grande", title:"pov", yt:"", hex:"#F0C9D7", toneHz:170, seed:"Gentle Mirror", tags:["Message","Her‚ÜíYou"], blurb:"Borrow my eyes for a minute‚Äîlook how worthy you are.", noteToAri:"This one teaches us to hold a kinder mirror. We‚Äôre practicing.", expl:"Mirror song; invites you to see yourself with her softness (Ariana ‚Üí You)." }
];

let state = { list: JSON.parse(JSON.stringify(PACK)), currentIndex:0, loop:true, player:null, audio:{ctx:null,osc:null,gain:null,on:false,muted:false}, editingIndex:null };
const $ = s=>document.querySelector(s); const $$=s=>Array.from(document.querySelectorAll(s));

function status(el,on){ if(el) el.classList.toggle('on', !!on); }
function dbToGain(db){ return Math.pow(10, db/20); }
function ensureAudio(){ if(state.audio.ctx) return; const ctx=new (window.AudioContext||window.webkitAudioContext)(); const osc=ctx.createOscillator(); const gain=ctx.createGain(); osc.type='sine'; gain.gain.value=dbToGain(-28); osc.connect(gain).connect(ctx.destination); osc.start(); state.audio={ctx,osc,gain,on:false,muted:false}; status($('#audioStatus'),true); }
function setToneHz(hz){ ensureAudio(); state.audio.osc.frequency.value=hz; $('#toneHzBadge').textContent = `${hz} Hz`; }
function setToneLevelFromSlider(v){ const db=-48+(v/100)*42; state.audio.gain.gain.value=dbToGain(db); }
function toggleTone(){ ensureAudio(); state.audio.on=!state.audio.on; $('#toneToggle').textContent= state.audio.on? 'üîä Tone: On':'üîá Tone: Off'; state.audio.gain.gain.value= state.audio.on? state.audio.gain.gain.value:0; }

function renderList(){
  $('#rows').innerHTML = state.list.map((it,i)=>{
    const verify = it.yt? '' : '<button class="verify" title="Missing ID‚Äîclick ‚úèÔ∏è to add">VERIFY</button>';
    return `<div class="row" data-i="${i}">
      <div class="idx">${i+1}</div>
      <div>
        <div class="song-title">${esc(it.title)} <span class="subtle">‚Äî ${esc(it.artist)}</span></div>
        <div class="controls" style="margin-top:6px"><span class="tag">${it.seed}</span><span class="tag">Hz <span class="kbd">${it.toneHz}</span></span><span class="tag">${(it.tags||[]).join(' ¬∑ ')}</span></div>
      </div>
      <div><span class="kbd" style="background:${it.hex};color:#000;border-color:rgba(0,0,0,.2)">${it.hex}</span></div>
      <div class="controls" style="justify-content:flex-end">
        ${verify}
        <button class="ghost play">‚ñ∂Ô∏è</button>
        <button class="ghost edit">‚úèÔ∏è</button>
        <button class="ghost info">‚ÑπÔ∏è</button>
      </div>
    </div>`;
  }).join('');
  $$('#rows .row').forEach(r=>{
    const i=Number(r.dataset.i);
    r.querySelector('.play').onclick=()=> playIndex(i);
    r.querySelector('.edit').onclick=()=> openDrawer(i);
    r.querySelector('.info').onclick=()=> alert(state.list[i].blurb+"

Illumina: "+(state.list[i].expl||''));
  });
  updateQueueBadge();
}

function updateQueueBadge(){ $('#qStatus').textContent = `${state.list.length} ${state.loop?'¬∑ loop':''}`; status($('#loopStatus'), state.loop); }

// Drawer
function openDrawer(i){
  state.editingIndex=i; const it=state.list[i];
  $('#dTitle').textContent = `Edit: ${it.title}`; $('#dTitleIn').value=it.title; $('#dYt').value=it.yt||''; $('#dHex').value=it.hex||''; $('#dSeed').value=it.seed||''; $('#dTone').value=it.toneHz||''; $('#dBlurb').value=it.blurb||''; $('#dNote').value=it.noteToAri||''; $('#drawer').classList.add('on');
}
$('#dSave').onclick=()=>{ const i=state.editingIndex; if(i==null) return; const it=state.list[i]; it.title=$('#dTitleIn').value; it.yt=$('#dYt').value; it.hex=$('#dHex').value; it.seed=$('#dSeed').value; it.toneHz=Number($('#dTone').value||it.toneHz); it.blurb=$('#dBlurb').value; it.noteToAri=$('#dNote').value; $('#drawer').classList.remove('on'); renderList(); };
$('#dCancel').onclick=()=> $('#drawer').classList.remove('on');

// Player
let YT_API_READY=false; let PLAYER_READY=false; function onYouTubeIframeAPIReady(){ YT_API_READY=true; status($('#ytStatus'),true); buildPlayer(); }
function buildPlayer(){ if(!YT_API_READY) return; if(state.player) return; state.player=new YT.Player('player',{height:'100%',width:'100%',videoId: null, playerVars:{rel:0,modestbranding:1,playsinline:1}, events:{ onReady:()=>{ PLAYER_READY=true; }, onStateChange:(e)=>{ if(e.data===YT.PlayerState.ENDED) nextTrack(); } }}); }
function ensurePlayerReady(cb){ if(PLAYER_READY && state.player) return cb(); const h=setInterval(()=>{ if(PLAYER_READY && state.player){ clearInterval(h); cb(); } }, 50); setTimeout(()=> clearInterval(h), 4000); }
function loadVideoByIndex(i){ const it=state.list[i]; if(!it.yt){ openDrawer(i); alert('This track is missing a YouTube ID. Paste the 11-char ID in the drawer (right), then Save.'); return; } state.currentIndex=i; setToneHz(it.toneHz); document.body.style.setProperty('--accent', it.hex||'#f6d7e6'); ensurePlayerReady(()=>{ state.player.loadVideoById(it.yt); state.player.playVideo(); }); }
function (i){ const it=state.list[i]; if(!it.yt){ openDrawer(i); alert('This track is missing a YouTube ID. Paste the 11-char ID in the drawer (right), then Save.'); return; } state.currentIndex=i; setToneHz(it.toneHz); document.body.style.setProperty('--accent', it.hex||'#f6d7e6'); state.player.loadVideoById(it.yt); }
function playIndex(i){ if(!state.player) buildPlayer(); loadVideoByIndex(i); }
function nextTrack(){ const n=state.currentIndex+1; const next= n<state.list.length? n : (state.loop? 0:null); if(next==null) return; loadVideoByIndex(next); }
function prevTrack(){ const p=state.currentIndex-1; const prev= p>=0? p : (state.loop? state.list.length-1:null); if(prev==null) return; loadVideoByIndex(prev); }

// Import/Export/Loop
$('#exportBtn').onclick = ()=>{ const lean=state.list.map(({artist,title,yt,hex,toneHz,seed,tags,blurb})=>({artist,title,yt,hex,toneHz,seed,tags,blurb})); const blob=new Blob([JSON.stringify(lean,null,2)],{type:'application/json'}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='ariana_voice_pack.json'; document.body.appendChild(a); a.click(); setTimeout(()=>{URL.revokeObjectURL(url); a.remove();},300); };
$('#saveAll').onclick = ()=> renderList();
$('#fileIn').onchange = e=>{ const f=e.target.files?.[0]; if(!f) return; const fr=new FileReader(); fr.onload=()=>{ try{ const data=JSON.parse(fr.result); if(!Array.isArray(data)) throw new Error('Expected an array'); const byTitle=new Map(state.list.map(x=>[x.title.toLowerCase(),x])); data.forEach(it=>{ if(it&&it.title){ byTitle.set(it.title.toLowerCase(), {...byTitle.get(it.title.toLowerCase()), ...it}); } }); state.list=Array.from(byTitle.values()); renderList(); }catch(err){ alert('Import error: '+err.message); } }; fr.readAsText(f); e.target.value=''; };
$('#loopBtn').onclick=()=>{ state.loop=!state.loop; updateQueueBadge(); };
$('#prevBtn').onclick=prevTrack; $('#nextBtn').onclick=nextTrack; $('#playBtn').onclick=()=>{ ensurePlayerReady(()=>{ if(state.list[state.currentIndex].yt){ loadVideoByIndex(state.currentIndex); } else { openDrawer(state.currentIndex); } }); }; $('#pauseBtn').onclick=()=> state.player && state.player.pauseVideo();

$('#toneToggle').onclick=toggleTone; $('#toneGain').oninput=e=> setToneLevelFromSlider(Number(e.target.value));

function esc(s){ return (s+"").replace(/[&<>\"]/g, c=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;"}[c])); }

// Boot
renderList(); setToneHz(state.list[0].toneHz);
</script>
<script src="https://www.youtube.com/iframe_api"></script>
<script>setTimeout(()=>{ if(!window.YT||!YT.loaded){ status(document.getElementById('ytStatus'), false);} }, 5000);</script>
</body>
</html>
